<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>60+ Tech</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap">
  <link rel="stylesheet" href="./css/styles-index.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" />
</head>
<body>
  <header>
    <nav class="navbar">
      <div class="logo">
        <img src="./img/logo.png" alt="Logo 60+ Tech">
      </div>
      <span class="detalhe-01"></span>
      <span class="detalhe-02"></span>
      <ul class="nav-menu">
        <li class="nav-item"><a href="#home" class="nav-link">Home</a></li>
        <li class="nav-item"><a href="./sobre-nos.html" class="nav-link">Sobre nós</a></li>
        <li class="nav-item" id="login" ><a href="./login-page/login-page.html"  class="nav-link">Login</a></li>
        <li class="nav-item"><a href="/src/pages/registration page/registration page.html" class="other-1" class="nav-link">Registrar-se</a></li>
      </ul>
      <div class="hamburger">
        <span class="bar"></span>
        <span class="bar"></span>
        <span class="bar"></span>
      </div>
    </nav>
  </header>
  <div class="background">
    <div class="img-background">
    </div>
    <div class="content">
      <h1>60+ TECH</h1>
      <div class="form">
        <input type="email" placeholder="Digite seu email..." style="font-size: 1em">
        <button><a style="text-decoration: none; color: black; font-size: large;" href="./registration page/registration page.html">Cadastre-se</a></button>
      </div>
    </div>
  </div>
  <main>
    <section id="servicos">
      <div class="servico">
        <button class="main-btn"><span class="material-symbols-outlined tutorial">
            subscriptions
          </span><a href="/tutoriais/tutoriais.html" class="no-underline">Tutoriais </a></button>
        <div class="descricao">
          <span class="main-detalhe-01"></span>
          <div class="box">
            <p>Explore nossos tutoriais detalhados e fáceis de seguir para aprender a usar as redes sociais e navegar na internet com confiança!</p>
          </div>
        </div>
        <img src="../img/tutoriais.jpg" alt="Tutoriais">
      </div>
      <div class="servico">
        <button class="main-btn"><span class="material-symbols-outlined medicamento">
            medical_services
          </span><a href="/medicamentos/meus-remedios.html" class="no-underline">Medicamentos </a></button>
        <div class="descricao">
          <span class="main-detalhe-02"></span>
          <div class="box">
            <p>Organize seus medicamentos de forma simples e eficiente e receba alertas personalizados para não esquecer nenhum horário!</p>
          </div>
          <img src="../img/medicamentos.jpg" alt="Medicamentos">
        </div>
      </div>
      <div class="servico">
        <button class="main-btn"><span class="material-symbols-outlined seguranca">
            verified_user
          </span></span><a href="/seguranca/dicas-segurança.html" class="no-underline">Segurança </a> </button>
        <div class="descricao">
          <span class="main-detalhe-03"></span>
          <div class="box">
            <p>Explore nossas dicas de segurança para não cair em golpes e estar sempre atento aos conteúdos compartilhados!</p>
          </div>
          <img src="../img/dicas de seguranca.jpg" alt="Dicas de Segurança">
        </div>
      </div>
    </section>
    <div class="descricao">
      <div class="box dicas">
        <div class="dicas">
          <h2>Dica do Dia</h2>
          <div class="video">
            <p>Descubra como reconhecer golpes virtuais e proteja-se contra fraudes online!</p>
            <a href="#" id="random-link">VEJA MAIS! -></a>
            <iframe src="https://www.youtube.com/embed/n7-48nJXtr8?si=gkvZhme6dkJS_-2o" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen>
              
            </iframe>
          </div>
        </div>
      </div>
    </div>
    <button class="main-btn" style="width:100%;background-color:#24aeda" ><a href="/dicas-do-dia/conselhos.html">BONÛS: Conselhos do dia !!! </a></button>

  </main>
  <footer>
    <nav>
      <ul>
        <li><a class="contato" href=""><span class="material-icons orange">phone</span> Contato: </a></li>
        <li><a class="email" href=""><span class="material-symbols-outlined mail">mail</span> 60+tech@gmail.com</a></li>
        <li><a class="githubLink" href="https://github.com/ICEI-PUC-Minas-PMV-SI/pmv-si-2024-1-pe1-t5-60tech" target="_blank"> <i class="fa fa-github" style="font-size:28px;color:#ECAE2A"></i> GitHub do projeto</a></li>
      </ul>
    </nav>
    <p class="copyright"> 2024 60+ TECH - Todos Direitos Reservados <span class="material-icons md-18 orange">copyright</span></p>
  </footer>
  <button id="open-popup-btn" class="open-popup-btn">Seus Remédios</button>
  </div>
  
  <div id="popup" class="popup">
    <div class="popup-content">
        <p>Seus remédios</p>
      <table>
        <thead>
          <tr>
            <th>NOME :</th>
            <th>QUANTIDADE :</th>
            <th>HORÁRIO :</th>
            <th>OBSERVAÇÕES:</th>
          </tr>
        </thead>
        <tbody id="medicamentos">
          <!-- Linhas da tabela serão inseridas aqui -->
        </tbody>
      </table>
        <button class="popup-btn" onclick="closePopup()">Ok, Fechar</button>
        <button class="popup-btn" id="email">E-mail</button>
    </div>
  </div>
  <script src="dicas.js"></script>
  <script src="popup.js"></script>
  <script src="menu.js"></script>
  <script src="./medicamentos/medicamentos.js"></script>
  <script>
    // Função para inicializar a página
function initPage() {
  // Verifica se há um usuário corrente no sessionStorage
  const usuarioCorrenteJSON = sessionStorage.getItem("usuarioCorrente");
  if (!usuarioCorrenteJSON) {
    // Se não houver usuário corrente, exibe o link de login
    document.getElementById('login').innerHTML = '<a href="./login-page/login-page.html" class="nav-link">Login</a>';
  } else {
    // Se houver usuário corrente, exibe o link de perfil
    document.getElementById('login').innerHTML = '<a href="./usuario/perfil.html" class="nav-link">Meu Perfil</a>';
  }
}

// Função para carregar os medicamentos do usuário e exibir no popup
function exibe(event) {
  fetch(apiUrl)
    .then(response => {
      if (!response.ok) {
        throw new Error("Erro ao buscar dados da API");
      }
      return response.json();
    })
    .then(data => {
      const usuarioCorrente = JSON.parse(sessionStorage.getItem("usuarioCorrente"));
      const medicamentosDoUsuario = data.filter(medicamento => medicamento.user_id === usuarioCorrente.id && medicamento.date === "2024-06-24");
      const tbody = document.getElementById("medicamentos");
      tbody.innerHTML = ""; // Limpa o conteúdo atual da tabela
      medicamentosDoUsuario.forEach(medicamento => {
        const tr = document.createElement("tr");
        tr.innerHTML = `
          <td>${medicamento.nome}</td>
          <td>${medicamento.quantidade}</td>
          <td>${medicamento.horario}</td>
          <td>${medicamento.observacao || "-"}</td>
        `;
        tbody.appendChild(tr); // Adiciona a linha à tabela
      });
      showPopup(); // Exibe o popup com os medicamentos
    })
    .catch(error => {
      console.error("Erro ao ler medicamentos via API:", error);
      alert("Erro ao buscar dados dos medicamentos");
    });
}

// Listener para o evento de carregamento da página
window.addEventListener("load", initPage);

// Adiciona um evento ao botão para verificar o login antes de abrir o popup
document.getElementById("open-popup-btn").addEventListener("click", function(event) {
    const usuarioCorrenteJSON = sessionStorage.getItem("usuarioCorrente");
    if (!usuarioCorrenteJSON) {
        displayMessage("É necessário fazer login para verificar os medicamentos cadastrados!");
        window.location.href = "./login-page/login-page.html";
        event.preventDefault(); // Previne a ação padrão do botão
    } else {
        // Chama a função para carregar e exibir os medicamentos
        exibe(event);
    }
});


document.getElementById("email").addEventListener("click", function(event) {
      // Dados do e-mail a serem enviados
      const emailData = {
        to: "yasminank@icloud.com", 
        subject: "Assunto do E-mail",
        text: "Conteúdo do E-mail",
      };

      // Envia uma solicitação POST para o servidor Node.js
      fetch("/send-email", {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
        },
        body: JSON.stringify(emailData),
      })
      .then(response => {
        if (response.ok) {
          alert("E-mail enviado com sucesso!");
        } else {
          throw new Error("Erro ao enviar e-mail");
        }
      })
      .catch(error => {
        console.error("Erro:", error);
        //alert("Erro ao enviar e-mail");
      });
    });
  </script>
</body>

</html>
